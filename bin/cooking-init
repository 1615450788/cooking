#!/usr/bin/env node

var fs = require('fs');
var cwd = require('cwd');
var utils = require('./../src/utils');
var CONTACTS = require('./../src/contacts');
var writeCookConfig = function(use) {
  fs.readFile(utils.dir('src/templates/cooking.conf.js'), function(err, context) {
    var newContext = context.toString().replace(/\${(use)}/g, use);
    fs.writeFile(cwd('cooking.conf.js'), newContext);
  });
};

module.exports = function(use) {
  var templatePath;

  use = use || CONTACTS.USEFUL.VUE;
  templatePath = 'src/templates/' + use + '/';

  if (!CONTACTS.USEFUL[use.toUpperCase()]) {
    return console.log('\nonly support vue, react and angular.\n');
  }

  fs.readdir(utils.dir(templatePath), function(err, files) {
    if (err) {
      throw Error(err);
    }

    files.forEach(function(file) {
      utils.moveFile(utils.dir(templatePath + '/' + file), cwd(file));
    });
    writeCookConfig(use);
    console.log('\nDone, enjoy it!\n');
  });
};
